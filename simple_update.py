#!/usr/bin/env python3
"""
–ü—Ä–æ—Å—Ç–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞ —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
"""

import subprocess
import time
import requests
import os

def check_server_status():
    """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–µ—Ä–∞"""
    print("üîç –ü—Ä–æ–≤–µ—Ä—è—é —Å—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–µ—Ä–∞...")
    try:
        response = requests.get("http://72.56.66.228", timeout=10)
        print(f"üìä –°—Ç–∞—Ç—É—Å: {response.status_code}")
        return response.status_code
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞: {e}")
        return None

def create_upload_instructions():
    """–°–æ–∑–¥–∞–µ—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏"""
    print("üìã –°–æ–∑–¥–∞—é –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏...")
    
    instructions = """# üöÄ –ò–ù–°–¢–†–£–ö–¶–ò–ò –ü–û –û–ë–ù–û–í–õ–ï–ù–ò–Æ –°–ï–†–í–ï–†–ê

## üìÅ –ì–û–¢–û–í–´–ï –§–ê–ô–õ–´:
- ‚úÖ app_for_server_final.py - –í–ï–†–°–ò–Ø –ë–ï–ó –î–ï–ú–û –î–ê–ù–ù–´–•
- ‚úÖ server_key.pub - –ü–£–ë–õ–ò–ß–ù–´–ô SSH –ö–õ–Æ–ß
- ‚úÖ server_key - –ü–†–ò–í–ê–¢–ù–´–ô SSH –ö–õ–Æ–ß

## üîß –°–ü–û–°–û–ë–´ –û–ë–ù–û–í–õ–ï–ù–ò–Ø:

### 1Ô∏è‚É£ –ß–ï–†–ï–ó –í–ï–ë-–ü–ê–ù–ï–õ–¨ –•–û–°–¢–ò–ù–ì–ê:
1. –í–æ–π–¥–∏—Ç–µ –≤ –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ö–æ—Å—Ç–∏–Ω–≥–æ–º
2. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª–æ–≤—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä
3. –ù–∞–π–¥–∏—Ç–µ —Ñ–∞–π–ª app.py
4. –°–æ–∑–¥–∞–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é: app_backup.py
5. –ó–∞–≥—Ä—É–∑–∏—Ç–µ app_for_server_final.py
6. –ü–µ—Ä–µ–∏–º–µ–Ω—É–π—Ç–µ –≤ app.py
7. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —á–µ—Ä–µ–∑ —Ç–µ—Ä–º–∏–Ω–∞–ª

### 2Ô∏è‚É£ –ß–ï–†–ï–ó SSH (–ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–ª—é—á–∞):
```bash
# –î–æ–±–∞–≤—å—Ç–µ –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –≤ –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
# –ó–∞—Ç–µ–º –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

# –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª
scp -i server_key app_for_server_final.py user@72.56.66.228:/tmp/

# –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É
ssh -i server_key user@72.56.66.228

# –ù–∞–π–¥–∏—Ç–µ –ø–∞–ø–∫—É —Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º
find / -name "app.py" 2>/dev/null

# –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø–∞–ø–∫—É
cd /path/to/your/app

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å—ã
pkill -f python

# –ó–∞–º–µ–Ω–∏—Ç–µ —Ñ–∞–π–ª
cp /tmp/app_for_server_final.py app.py

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
python3 app.py
```

### 3Ô∏è‚É£ –ß–ï–†–ï–ó FTP/SFTP:
1. –û—Ç–∫—Ä–æ–π—Ç–µ FTP –∫–ª–∏–µ–Ω—Ç
2. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ 72.56.66.228
3. –ù–∞–π–¥–∏—Ç–µ –ø–∞–ø–∫—É —Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º
4. –ó–∞–≥—Ä—É–∑–∏—Ç–µ app_for_server_final.py
5. –ü–µ—Ä–µ–∏–º–µ–Ω—É–π—Ç–µ –≤ app.py
6. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

## üîç –ü–†–û–í–ï–†–ö–ê –ü–û–°–õ–ï –û–ë–ù–û–í–õ–ï–ù–ò–Ø:
1. –û—Ç–∫—Ä–æ–π—Ç–µ http://72.56.66.228/module/trends
2. –ù–∞–∂–º–∏—Ç–µ "–°–æ–±—Ä–∞—Ç—å —Ä–∏–ª—Å—ã –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤"
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ù–ï–¢ –¥–µ–º–æ –¥–∞–Ω–Ω—ã—Ö

## ‚ö†Ô∏è –í–ê–ñ–ù–û:
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª app.py –∑–∞–º–µ–Ω–µ–Ω
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: tail -f app.log
"""
    
    with open("UPLOAD_INSTRUCTIONS.md", "w") as f:
        f.write(instructions)
    
    print("‚úÖ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ —Å–æ–∑–¥–∞–Ω—ã: UPLOAD_INSTRUCTIONS.md")

def create_simple_web_server():
    """–°–æ–∑–¥–∞–µ—Ç –ø—Ä–æ—Å—Ç–æ–π –≤–µ–±-—Å–µ—Ä–≤–µ—Ä –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤"""
    print("üåê –ó–∞–ø—É—Å–∫–∞—é –≤–µ–±-—Å–µ—Ä–≤–µ—Ä –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤...")
    
    try:
        # –ó–∞–ø—É—Å–∫–∞–µ–º HTTP —Å–µ—Ä–≤–µ—Ä
        subprocess.Popen(["python3", "-m", "http.server", "8080"], 
                        stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL)
        
        print("‚úÖ –í–µ–±-—Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É 8080")
        print("üåê –û—Ç–∫—Ä–æ–π—Ç–µ: http://localhost:8080")
        print("üì• –°–∫–∞—á–∞–π—Ç–µ —Ñ–∞–π–ª—ã –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–∞")
        
        return True
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞: {e}")
        return False

def main():
    print("üöÄ –ü–†–û–°–¢–û–ï –û–ë–ù–û–í–õ–ï–ù–ò–ï –°–ï–†–í–ï–†–ê")
    print("="*50)
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å
    status = check_server_status()
    if status == 200:
        print("‚úÖ –°–µ—Ä–≤–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç!")
    elif status == 502:
        print("‚ùå –°–µ—Ä–≤–µ—Ä –Ω–µ –∑–∞–ø—É—â–µ–Ω (502 Bad Gateway)")
    else:
        print(f"‚ö†Ô∏è –°—Ç–∞—Ç—É—Å: {status}")
    
    # –°–æ–∑–¥–∞–µ–º –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
    create_upload_instructions()
    
    # –ó–∞–ø—É—Å–∫–∞–µ–º –≤–µ–±-—Å–µ—Ä–≤–µ—Ä
    create_simple_web_server()
    
    print("\n" + "="*50)
    print("üìã –ì–û–¢–û–í–´–ï –§–ê–ô–õ–´:")
    print("‚úÖ app_for_server_final.py - –í–ï–†–°–ò–Ø –ë–ï–ó –î–ï–ú–û –î–ê–ù–ù–´–•")
    print("‚úÖ server_key.pub - –ü–£–ë–õ–ò–ß–ù–´–ô SSH –ö–õ–Æ–ß")
    print("‚úÖ server_key - –ü–†–ò–í–ê–¢–ù–´–ô SSH –ö–õ–Æ–ß")
    print("‚úÖ UPLOAD_INSTRUCTIONS.md - –ò–ù–°–¢–†–£–ö–¶–ò–ò")
    
    print("\nüåê –í–ï–ë-–°–ï–†–í–ï–†: http://localhost:8080")
    print("üì• –°–∫–∞—á–∞–π—Ç–µ —Ñ–∞–π–ª—ã –∏ –æ–±–Ω–æ–≤–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä")
    
    print("\nüîß –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò:")
    print("1. –°–∫–∞—á–∞–π—Ç–µ app_for_server_final.py")
    print("2. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä —á–µ—Ä–µ–∑ –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è")
    print("3. –ó–∞–º–µ–Ω–∏—Ç–µ app.py –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ")
    print("4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ")
    print("5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç")

if __name__ == "__main__":
    main()
