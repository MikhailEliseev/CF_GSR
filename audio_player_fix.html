<!-- –£–ª—É—á—à–µ–Ω–Ω—ã–π –∞—É–¥–∏–æ –ø–ª–µ–µ—Ä —Å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞–º–∏ -->
<div id="audioResult" class="mt-4" style="display: none;">
    <h5 class="gsr-text-primary">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∞—É–¥–∏–æ:</h5>
    
    <!-- –û—Å–Ω–æ–≤–Ω–æ–π HTML5 –ø–ª–µ–µ—Ä -->
    <audio controls class="w-100 mb-3" id="audioPlayer" preload="metadata">
        <source id="audioSource" src="" type="audio/mpeg">
        <source id="audioSourceOgg" src="" type="audio/ogg">
        –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∞—É–¥–∏–æ —ç–ª–µ–º–µ–Ω—Ç.
    </audio>
    
    <!-- –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –ø–ª–µ–µ—Ä –¥–ª—è Chrome -->
    <div id="chromePlayer" class="d-none">
        <div class="alert alert-info">
            <i class="fas fa-info-circle me-2"></i>
            <strong>Chrome –ø–ª–µ–µ—Ä:</strong>
            <button class="btn btn-sm btn-primary ms-2" onclick="playChromeAudio()">
                <i class="fas fa-play me-1"></i>–í–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏
            </button>
            <button class="btn btn-sm btn-secondary ms-1" onclick="pauseChromeAudio()">
                <i class="fas fa-pause me-1"></i>–ü–∞—É–∑–∞
            </button>
        </div>
    </div>
    
    <!-- –°—Å—ã–ª–∫–∞ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è -->
    <div class="mt-2">
        <a href="#" id="downloadLink" class="btn btn-outline-primary btn-sm" download>
            <i class="fas fa-download me-1"></i>–°–∫–∞—á–∞—Ç—å –∞—É–¥–∏–æ
        </a>
    </div>
    
    <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ñ–∞–π–ª–µ -->
    <div class="mt-2 text-muted small">
        <span id="audioInfo">–ì–æ—Ç–æ–≤–æ –∫ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—é</span>
    </div>
</div>

<script>
// –£–ª—É—á—à–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∞—É–¥–∏–æ
function setupAudioPlayer(audioUrl) {
    console.log('üéµ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞—É–¥–∏–æ –ø–ª–µ–µ—Ä–∞:', audioUrl);
    
    const audioPlayer = document.getElementById('audioPlayer');
    const audioSource = document.getElementById('audioSource');
    const audioSourceOgg = document.getElementById('audioSourceOgg');
    const downloadLink = document.getElementById('downloadLink');
    const audioInfo = document.getElementById('audioInfo');
    const chromePlayer = document.getElementById('chromePlayer');
    
    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏—Å—Ç–æ—á–Ω–∏–∫–∏
    audioSource.src = audioUrl;
    audioSourceOgg.src = audioUrl.replace('.mp3', '.ogg');
    downloadLink.href = audioUrl;
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
    audioInfo.textContent = `–ê—É–¥–∏–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ: ${audioUrl.split('/').pop()}`;
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–¥–µ—Ä–∂–∫—É –±—Ä–∞—É–∑–µ—Ä–∞
    const isChrome = /Chrome/.test(navigator.userAgent);
    const isSafari = /Safari/.test(navigator.userAgent) && !/Chrome/.test(navigator.userAgent);
    
    if (isChrome) {
        console.log('üîß Chrome –æ–±–Ω–∞—Ä—É–∂–µ–Ω - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –ø–ª–µ–µ—Ä');
        chromePlayer.classList.remove('d-none');
    }
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
    audioPlayer.addEventListener('loadedmetadata', function() {
        console.log('‚úÖ –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∞—É–¥–∏–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã');
        audioInfo.textContent = `–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: ${Math.round(audioPlayer.duration)} —Å–µ–∫`;
    });
    
    audioPlayer.addEventListener('error', function(e) {
        console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∞—É–¥–∏–æ:', e);
        audioInfo.textContent = '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∞—É–¥–∏–æ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª.';
        
        if (isChrome) {
            chromePlayer.classList.remove('d-none');
        }
    });
    
    // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞
    audioPlayer.load();
}

// –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è Chrome –ø–ª–µ–µ—Ä–∞
function playChromeAudio() {
    const audioPlayer = document.getElementById('audioPlayer');
    audioPlayer.play().catch(e => {
        console.error('–û—à–∏–±–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è:', e);
        alert('–ù–µ —É–¥–∞–ª–æ—Å—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –∞—É–¥–∏–æ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª.');
    });
}

function pauseChromeAudio() {
    const audioPlayer = document.getElementById('audioPlayer');
    audioPlayer.pause();
}

// –ì–ª–æ–±–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è –∞—É–¥–∏–æ
window.currentAudioUrl = null;
</script>
